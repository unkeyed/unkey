# SPIRE Server Configuration - Development Environment

server {
  bind_address = "127.0.0.1"
  socket_path = "/var/lib/spire/server/server.sock"
  trust_domain = "development.unkey.cloud"
  data_dir = "/var/lib/spire/server/data"
  log_level = "DEBUG"
  log_format = "text" # Human-readable for development

  default_x509_svid_ttl = "5m"
  default_jwt_svid_ttl = "5m"

  ca_ttl = "8760h"
  ca_key_type = "ec-p256"
  ca_subject = {
    country = ["US"],
    organization = ["Unkey"],
    common_name = "Unkey Development CA",
  }

  audit_log_enabled = true
}

plugins {
  DataStore "sql" {
    plugin_data {
      database_type = "sqlite3"
      connection_string = "/var/lib/spire/server/data/datastore.sqlite3"
    }
  }

  NodeAttestor "join_token" {
    plugin_data {}
  }

  KeyManager "disk" {
    plugin_data {
      keys_path = "/var/lib/spire/server/keys/keys.json"
    }
  }
}

health_checks {
  listener_enabled = true
  bind_address = "127.0.0.1"
  live_path = "/live"
  ready_path = "/ready"
}

telemetry {
  Prometheus {
    host = "127.0.0.1"
    port = 9988
  }
}
