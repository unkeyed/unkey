Request:
  required: true
  content:
    application/json:
      schema:
        "$ref": "#/V2KeysRemovePermissionsRequestBody"

V2KeysRemovePermissionsRequestBody:
  type: object
  required:
    - keyId
    - permissions
  properties:
    keyId:
      type: string
      minLength: 3
      maxLength: 255
      pattern: "^[a-zA-Z0-9_]+$"
      description: |
        The unique identifier of the key to remove permissions from (begins with 'key_').
        This ID comes from the createKey response and identifies which key will lose permissions.
        This is the database ID, not the actual API key string.
      example: key_2cGKbMxRyIzhCxo1Idjz8q
    permissions:
      type: array
      minItems: 1
      maxItems: 1000
      description: |
        The permissions to remove from this key.
        Operations are idempotent - removing non-existent permissions has no effect.
        Permission changes take effect immediately for new verifications.
      items:
        type: object
        properties:
          id:
            type: string
            description: |
              The ID of an existing permission (begins with 'perm_').
              Provide either ID or slug for each permission, not both.
            example: perm_1n9McEIBSqy44Qy7hzWyM5
          slug:
            type: string
            description: |
              The slug of the permission.
              Provide either ID or slug for each permission, not both.
            example: documents.write
        oneOf:
          - required: [id]
          - required: [slug]
  additionalProperties: false