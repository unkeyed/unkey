Request:
  required: true
  content:
    application/json:
      schema:
        "$ref": "#/V2KeysSetRolesRequestBody"

V2KeysSetRolesRequestBody:
  type: object
  required:
    - keyId
    - roles
  properties:
    keyId:
      type: string
      minLength: 3
      maxLength: 255
      pattern: "^[a-zA-Z0-9_]+$"
      description: |
        The unique identifier of the key to set roles on (begins with 'key_').
        This ID comes from the createKey response and identifies which key will have its roles replaced.
        This is the database ID, not the actual API key string.
      example: key_2cGKbMxRyIzhCxo1Idjz8q
    roles:
      type: array
      maxItems: 100
      description: |
        The roles to set for this key. This is a complete replacement operation.
        Providing an empty array removes all role assignments from the key.
        All roles must already exist in the workspace.
        Role assignments take effect immediately for new verifications.
      items:
        type: object
        properties:
          id:
            type: string
            description: |
              The ID of an existing role (begins with 'role_').
              Provide either ID or name for each role, not both.
            example: role_1n9McEIBSqy44Qy7hzWyM5
          name:
            type: string
            description: |
              The name of the role.
              Provide either ID or name for each role, not both.
            example: editor
        oneOf:
          - required: [id]
          - required: [name]
  additionalProperties: false