Request:
  required: true
  content:
    application/json:
      schema:
        "$ref": "#/V2KeysRemoveRolesRequestBody"

V2KeysRemoveRolesRequestBody:
  type: object
  required:
    - keyId
    - roles
  properties:
    keyId:
      type: string
      minLength: 3
      maxLength: 255
      pattern: "^[a-zA-Z0-9_]+$"
      description: |
        The unique identifier of the key to remove roles from (begins with 'key_').
        This ID comes from the createKey response and identifies which key will lose roles.
        This is the database ID, not the actual API key string.
      example: key_2cGKbMxRyIzhCxo1Idjz8q
    roles:
      type: array
      minItems: 1
      maxItems: 100
      description: |
        The roles to remove from this key.
        Operations are idempotent - removing non-assigned roles has no effect.
        Role changes take effect immediately for new verifications.
      items:
        type: object
        properties:
          id:
            type: string
            description: |
              The ID of an existing role (begins with 'role_').
              Provide either ID or name for each role, not both.
            example: role_1n9McEIBSqy44Qy7hzWyM5
          name:
            type: string
            description: |
              The name of the role.
              Provide either ID or name for each role, not both.
            example: editor
        oneOf:
          - required: [id]
          - required: [name]
  additionalProperties: false