// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: gateway_list_desired.sql

package db

import (
	"context"
)

const listDesiredGateways = `-- name: ListDesiredGateways :many
SELECT
    gateways.id, gateways.workspace_id, gateways.project_id, gateways.environment_id, gateways.k8s_crd_name, gateways.k8s_service_name, gateways.region, gateways.image, gateways.desired_state, gateways.health, gateways.desired_replicas, gateways.replicas, gateways.cpu_millicores, gateways.memory_mib, gateways.created_at, gateways.updated_at,
    workspaces.id, workspaces.org_id, workspaces.name, workspaces.slug, workspaces.k8s_namespace, workspaces.partition_id, workspaces.plan, workspaces.tier, workspaces.stripe_customer_id, workspaces.stripe_subscription_id, workspaces.beta_features, workspaces.features, workspaces.subscriptions, workspaces.enabled, workspaces.delete_protection, workspaces.created_at_m, workspaces.updated_at_m, workspaces.deleted_at_m
FROM ` + "`" + `gateways` + "`" + `
INNER JOIN ` + "`" + `workspaces` + "`" + ` ON gateways.workspace_id = workspaces.id
WHERE (? = '' OR region = ?)
    AND desired_state = ?
    AND gateways.id > ?
ORDER BY gateways.id ASC
LIMIT ?
`

type ListDesiredGatewaysParams struct {
	Region           string               `db:"region"`
	DesiredState     GatewaysDesiredState `db:"desired_state"`
	PaginationCursor string               `db:"pagination_cursor"`
	Limit            int32                `db:"limit"`
}

type ListDesiredGatewaysRow struct {
	Gateway   Gateway   `db:"gateway"`
	Workspace Workspace `db:"workspace"`
}

// ListDesiredGateways
//
//	SELECT
//	    gateways.id, gateways.workspace_id, gateways.project_id, gateways.environment_id, gateways.k8s_crd_name, gateways.k8s_service_name, gateways.region, gateways.image, gateways.desired_state, gateways.health, gateways.desired_replicas, gateways.replicas, gateways.cpu_millicores, gateways.memory_mib, gateways.created_at, gateways.updated_at,
//	    workspaces.id, workspaces.org_id, workspaces.name, workspaces.slug, workspaces.k8s_namespace, workspaces.partition_id, workspaces.plan, workspaces.tier, workspaces.stripe_customer_id, workspaces.stripe_subscription_id, workspaces.beta_features, workspaces.features, workspaces.subscriptions, workspaces.enabled, workspaces.delete_protection, workspaces.created_at_m, workspaces.updated_at_m, workspaces.deleted_at_m
//	FROM `gateways`
//	INNER JOIN `workspaces` ON gateways.workspace_id = workspaces.id
//	WHERE (? = '' OR region = ?)
//	    AND desired_state = ?
//	    AND gateways.id > ?
//	ORDER BY gateways.id ASC
//	LIMIT ?
func (q *Queries) ListDesiredGateways(ctx context.Context, db DBTX, arg ListDesiredGatewaysParams) ([]ListDesiredGatewaysRow, error) {
	rows, err := db.QueryContext(ctx, listDesiredGateways,
		arg.Region,
		arg.Region,
		arg.DesiredState,
		arg.PaginationCursor,
		arg.Limit,
	)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListDesiredGatewaysRow
	for rows.Next() {
		var i ListDesiredGatewaysRow
		if err := rows.Scan(
			&i.Gateway.ID,
			&i.Gateway.WorkspaceID,
			&i.Gateway.ProjectID,
			&i.Gateway.EnvironmentID,
			&i.Gateway.K8sCrdName,
			&i.Gateway.K8sServiceName,
			&i.Gateway.Region,
			&i.Gateway.Image,
			&i.Gateway.DesiredState,
			&i.Gateway.Health,
			&i.Gateway.DesiredReplicas,
			&i.Gateway.Replicas,
			&i.Gateway.CpuMillicores,
			&i.Gateway.MemoryMib,
			&i.Gateway.CreatedAt,
			&i.Gateway.UpdatedAt,
			&i.Workspace.ID,
			&i.Workspace.OrgID,
			&i.Workspace.Name,
			&i.Workspace.Slug,
			&i.Workspace.K8sNamespace,
			&i.Workspace.PartitionID,
			&i.Workspace.Plan,
			&i.Workspace.Tier,
			&i.Workspace.StripeCustomerID,
			&i.Workspace.StripeSubscriptionID,
			&i.Workspace.BetaFeatures,
			&i.Workspace.Features,
			&i.Workspace.Subscriptions,
			&i.Workspace.Enabled,
			&i.Workspace.DeleteProtection,
			&i.Workspace.CreatedAtM,
			&i.Workspace.UpdatedAtM,
			&i.Workspace.DeletedAtM,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
