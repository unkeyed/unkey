// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: deployment_topology_by_id_and_region.sql

package db

import (
	"context"
	"database/sql"
)

const findDeploymentTopologyByIDAndRegion = `-- name: FindDeploymentTopologyByIDAndRegion :one
SELECT
    d.id,
    d.k8s_crd_name,
    w.k8s_namespace,
    d.workspace_id,
    d.project_id,
    d.environment_id,
    d.image,
    dt.region,
    d.cpu_millicores,
    d.memory_mib,
    dt.replicas,
    d.desired_state
FROM ` + "`" + `deployment_topology` + "`" + ` dt
INNER JOIN ` + "`" + `deployments` + "`" + ` d ON dt.deployment_id = d.id
INNER JOIN ` + "`" + `workspaces` + "`" + ` w ON d.workspace_id = w.id
WHERE  dt.region = ?
    AND dt.deployment_id = ?
LIMIT 1
`

type FindDeploymentTopologyByIDAndRegionParams struct {
	Region       string `db:"region"`
	DeploymentID string `db:"deployment_id"`
}

type FindDeploymentTopologyByIDAndRegionRow struct {
	ID            string                  `db:"id"`
	K8sCrdName    string                  `db:"k8s_crd_name"`
	K8sNamespace  sql.NullString          `db:"k8s_namespace"`
	WorkspaceID   string                  `db:"workspace_id"`
	ProjectID     string                  `db:"project_id"`
	EnvironmentID string                  `db:"environment_id"`
	Image         sql.NullString          `db:"image"`
	Region        string                  `db:"region"`
	CpuMillicores int32                   `db:"cpu_millicores"`
	MemoryMib     int32                   `db:"memory_mib"`
	Replicas      int32                   `db:"replicas"`
	DesiredState  DeploymentsDesiredState `db:"desired_state"`
}

// FindDeploymentTopologyByIDAndRegion
//
//	SELECT
//	    d.id,
//	    d.k8s_crd_name,
//	    w.k8s_namespace,
//	    d.workspace_id,
//	    d.project_id,
//	    d.environment_id,
//	    d.image,
//	    dt.region,
//	    d.cpu_millicores,
//	    d.memory_mib,
//	    dt.replicas,
//	    d.desired_state
//	FROM `deployment_topology` dt
//	INNER JOIN `deployments` d ON dt.deployment_id = d.id
//	INNER JOIN `workspaces` w ON d.workspace_id = w.id
//	WHERE  dt.region = ?
//	    AND dt.deployment_id = ?
//	LIMIT 1
func (q *Queries) FindDeploymentTopologyByIDAndRegion(ctx context.Context, db DBTX, arg FindDeploymentTopologyByIDAndRegionParams) (FindDeploymentTopologyByIDAndRegionRow, error) {
	row := db.QueryRowContext(ctx, findDeploymentTopologyByIDAndRegion, arg.Region, arg.DeploymentID)
	var i FindDeploymentTopologyByIDAndRegionRow
	err := row.Scan(
		&i.ID,
		&i.K8sCrdName,
		&i.K8sNamespace,
		&i.WorkspaceID,
		&i.ProjectID,
		&i.EnvironmentID,
		&i.Image,
		&i.Region,
		&i.CpuMillicores,
		&i.MemoryMib,
		&i.Replicas,
		&i.DesiredState,
	)
	return i, err
}
