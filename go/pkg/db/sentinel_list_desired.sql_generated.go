// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: sentinel_list_desired.sql

package db

import (
	"context"
)

const listDesiredSentinels = `-- name: ListDesiredSentinels :many
SELECT
    sentinels.pk, sentinels.id, sentinels.workspace_id, sentinels.project_id, sentinels.environment_id, sentinels.k8s_name, sentinels.k8s_address, sentinels.region, sentinels.image, sentinels.desired_state, sentinels.health, sentinels.desired_replicas, sentinels.available_replicas, sentinels.cpu_millicores, sentinels.memory_mib, sentinels.created_at, sentinels.updated_at,
    workspaces.id, workspaces.org_id, workspaces.name, workspaces.slug, workspaces.k8s_namespace, workspaces.partition_id, workspaces.plan, workspaces.tier, workspaces.stripe_customer_id, workspaces.stripe_subscription_id, workspaces.beta_features, workspaces.features, workspaces.subscriptions, workspaces.enabled, workspaces.delete_protection, workspaces.created_at_m, workspaces.updated_at_m, workspaces.deleted_at_m
FROM ` + "`" + `sentinels` + "`" + `
INNER JOIN ` + "`" + `workspaces` + "`" + ` ON sentinels.workspace_id = workspaces.id
WHERE (? = '' OR region = ?)
    AND desired_state = ?
    AND sentinels.id > ?
ORDER BY sentinels.id ASC
LIMIT ?
`

type ListDesiredSentinelsParams struct {
	Region           string                `db:"region"`
	DesiredState     SentinelsDesiredState `db:"desired_state"`
	PaginationCursor string                `db:"pagination_cursor"`
	Limit            int32                 `db:"limit"`
}

type ListDesiredSentinelsRow struct {
	Sentinel  Sentinel  `db:"sentinel"`
	Workspace Workspace `db:"workspace"`
}

// ListDesiredSentinels
//
//	SELECT
//	    sentinels.pk, sentinels.id, sentinels.workspace_id, sentinels.project_id, sentinels.environment_id, sentinels.k8s_name, sentinels.k8s_address, sentinels.region, sentinels.image, sentinels.desired_state, sentinels.health, sentinels.desired_replicas, sentinels.available_replicas, sentinels.cpu_millicores, sentinels.memory_mib, sentinels.created_at, sentinels.updated_at,
//	    workspaces.id, workspaces.org_id, workspaces.name, workspaces.slug, workspaces.k8s_namespace, workspaces.partition_id, workspaces.plan, workspaces.tier, workspaces.stripe_customer_id, workspaces.stripe_subscription_id, workspaces.beta_features, workspaces.features, workspaces.subscriptions, workspaces.enabled, workspaces.delete_protection, workspaces.created_at_m, workspaces.updated_at_m, workspaces.deleted_at_m
//	FROM `sentinels`
//	INNER JOIN `workspaces` ON sentinels.workspace_id = workspaces.id
//	WHERE (? = '' OR region = ?)
//	    AND desired_state = ?
//	    AND sentinels.id > ?
//	ORDER BY sentinels.id ASC
//	LIMIT ?
func (q *Queries) ListDesiredSentinels(ctx context.Context, db DBTX, arg ListDesiredSentinelsParams) ([]ListDesiredSentinelsRow, error) {
	rows, err := db.QueryContext(ctx, listDesiredSentinels,
		arg.Region,
		arg.Region,
		arg.DesiredState,
		arg.PaginationCursor,
		arg.Limit,
	)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListDesiredSentinelsRow
	for rows.Next() {
		var i ListDesiredSentinelsRow
		if err := rows.Scan(
			&i.Sentinel.Pk,
			&i.Sentinel.ID,
			&i.Sentinel.WorkspaceID,
			&i.Sentinel.ProjectID,
			&i.Sentinel.EnvironmentID,
			&i.Sentinel.K8sName,
			&i.Sentinel.K8sAddress,
			&i.Sentinel.Region,
			&i.Sentinel.Image,
			&i.Sentinel.DesiredState,
			&i.Sentinel.Health,
			&i.Sentinel.DesiredReplicas,
			&i.Sentinel.AvailableReplicas,
			&i.Sentinel.CpuMillicores,
			&i.Sentinel.MemoryMib,
			&i.Sentinel.CreatedAt,
			&i.Sentinel.UpdatedAt,
			&i.Workspace.ID,
			&i.Workspace.OrgID,
			&i.Workspace.Name,
			&i.Workspace.Slug,
			&i.Workspace.K8sNamespace,
			&i.Workspace.PartitionID,
			&i.Workspace.Plan,
			&i.Workspace.Tier,
			&i.Workspace.StripeCustomerID,
			&i.Workspace.StripeSubscriptionID,
			&i.Workspace.BetaFeatures,
			&i.Workspace.Features,
			&i.Workspace.Subscriptions,
			&i.Workspace.Enabled,
			&i.Workspace.DeleteProtection,
			&i.Workspace.CreatedAtM,
			&i.Workspace.UpdatedAtM,
			&i.Workspace.DeletedAtM,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
