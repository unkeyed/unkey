---
title: Next.js
description: API Authentication in Next.js
---

## Prerequisites

- [Create a workspace](/quickstart/onboarding#2-create-your-first-workspace)
- [Create an API](/quickstart/onboarding#2-create-your-first-api)

<Card>
  We also have a [Next.js example](https://github.com/unkeyed/unkey/tree/main/examples/nextjs) ready to deploy on Vercel.

    [![Deploy with Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Funkeyed%2Funkey%2Ftree%2Fmain%2Fexamples%2Fnextjs&project-name=unkey-with-nextjs&repository-name=unkey-with-nextjs&integration-ids=oac_D84Ib6K2pS6CDQXxQbzsYxsh)

</Card>

If you don't have a Next.js app yet, you can quickly create one with the following command:


<Tabs>
  <Tab title="bun">
    ```bash
    bun create next-app
    ```
  </Tab>
  <Tab title="pnpm">
    ```bash
    pnpm create next-app
    ```
  </Tab>
  <Tab title="yarn">
    ```bash
    yarn create next-app
    ```
  </Tab>
  <Tab title="npm">
    ```bash
    npm create next-app@latest
    ```
  </Tab>
</Tabs>

<Steps titleSize="h3">
<Step  title="Install">

Now install the `@unkey/nextjs` package

<Tabs>
  <Tab title="bun">
  ```bash
    bun install @unkey/nextjs
    ```
  </Tab>
  <Tab title="pnpm">
  ```bash
    pnpm add @unkey/nextjs
    ```
  </Tab>
  <Tab title="yarn">
  ```bash
    yarn add @unkey/nextjs
    ```
  </Tab>
  <Tab title="npm">
  ```bash
    npm install @unkey/nextjs
    ```
  </Tab>
</Tabs>



</Step>

{/* step 2 Creating a protected route */}
<Snippet file='create-protected-route.mdx' />




<Step title="Running it">

```bash
npm run dev
```

</Step>

{/* step 4 Try it out */}
<Snippet file='try-it-out.mdx' />

</Steps>

## Options

The `withUnkey` wrapper takes a configuration object as a second optional argument to configure the request handling.
These are optional and the defaults should be fine for most use cases.

```ts
export const POST = withUnkey(handler, {
  getKey: ...,
  handleInvalidKey: ...,
  onError: ...,
})
```


<ParamField body="getKey" type="(NextRequest) => string | null | NextResponse">
  How to get the key from the request.
  Usually the key is provided in an `Authorization` header, but you can do what you want.

  Return the key as string, or null if it doesn't exist.
  You can also directly return a `NextResponse` which will be sent to the client without invoking the handler function.

  Defaults to: `req => req.headers.get("Authorization")?.replace("Bearer ", "") ?? null`
</ParamField>

<ParamField body="handleInvalidKey" type="(NextRequest, UnkeyContext) => NextResponse | Promise<NextResponse>)">
  Return a custom response when a key is invalid.
</ParamField>

<ParamField body="onError" type="(NextRequest, UnkeyError) => NextResponse | Promise<NextResponse>">
 What to do if things go wrong. This could be a network error for example.
 The SDK will automatically retry the request up to 5 times, but if it still fails, this function will be called.
</ParamField>
