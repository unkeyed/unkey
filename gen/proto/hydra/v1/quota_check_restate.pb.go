// Code generated by protoc-gen-go-restate. DO NOT EDIT.
// versions:
// - protoc-gen-go-restate v0.1
// - protoc             (unknown)
// source: hydra/v1/quota_check.proto

package hydrav1

import (
	fmt "fmt"
	sdk_go "github.com/restatedev/sdk-go"
	encoding "github.com/restatedev/sdk-go/encoding"
	ingress "github.com/restatedev/sdk-go/ingress"
)

// QuotaCheckServiceClient is the client API for hydra.v1.QuotaCheckService service.
//
// QuotaCheckService monitors workspace quota usage and sends notifications.
//
// Keyed by billing period (e.g., "2026-01") to track notifications per month.
// Uses Restate state to deduplicate notifications - each workspace is only
// notified once per billing period when they first exceed their quota.
type QuotaCheckServiceClient interface {
	// RunCheck queries all workspace usage and sends Slack notifications for
	// newly exceeded quotas. Safe to call multiple times per day - uses state
	// to avoid duplicate notifications.
	//
	// Key: billing period in "YYYY-MM" format (e.g., "2026-01")
	RunCheck(opts ...sdk_go.ClientOption) sdk_go.Client[*RunCheckRequest, *RunCheckResponse]
	// SendMonthlySummary sends a summary of all exceeded workspaces for the month.
	// Intended to be called on the last day of the billing period.
	//
	// Key: billing period in "YYYY-MM" format (e.g., "2026-01")
	SendMonthlySummary(opts ...sdk_go.ClientOption) sdk_go.Client[*SendMonthlySummaryRequest, *SendMonthlySummaryResponse]
}

type quotaCheckServiceClient struct {
	ctx     sdk_go.Context
	key     string
	options []sdk_go.ClientOption
}

func NewQuotaCheckServiceClient(ctx sdk_go.Context, key string, opts ...sdk_go.ClientOption) QuotaCheckServiceClient {
	cOpts := append([]sdk_go.ClientOption{sdk_go.WithProtoJSON}, opts...)
	return &quotaCheckServiceClient{
		ctx,
		key,
		cOpts,
	}
}
func (c *quotaCheckServiceClient) RunCheck(opts ...sdk_go.ClientOption) sdk_go.Client[*RunCheckRequest, *RunCheckResponse] {
	cOpts := c.options
	if len(opts) > 0 {
		cOpts = append(append([]sdk_go.ClientOption{}, cOpts...), opts...)
	}
	return sdk_go.WithRequestType[*RunCheckRequest](sdk_go.Object[*RunCheckResponse](c.ctx, "hydra.v1.QuotaCheckService", c.key, "RunCheck", cOpts...))
}

func (c *quotaCheckServiceClient) SendMonthlySummary(opts ...sdk_go.ClientOption) sdk_go.Client[*SendMonthlySummaryRequest, *SendMonthlySummaryResponse] {
	cOpts := c.options
	if len(opts) > 0 {
		cOpts = append(append([]sdk_go.ClientOption{}, cOpts...), opts...)
	}
	return sdk_go.WithRequestType[*SendMonthlySummaryRequest](sdk_go.Object[*SendMonthlySummaryResponse](c.ctx, "hydra.v1.QuotaCheckService", c.key, "SendMonthlySummary", cOpts...))
}

// QuotaCheckServiceIngressClient is the ingress client API for hydra.v1.QuotaCheckService service.
//
// This client is used to call the service from outside of a Restate context.
type QuotaCheckServiceIngressClient interface {
	// RunCheck queries all workspace usage and sends Slack notifications for
	// newly exceeded quotas. Safe to call multiple times per day - uses state
	// to avoid duplicate notifications.
	//
	// Key: billing period in "YYYY-MM" format (e.g., "2026-01")
	RunCheck() ingress.Requester[*RunCheckRequest, *RunCheckResponse]
	// SendMonthlySummary sends a summary of all exceeded workspaces for the month.
	// Intended to be called on the last day of the billing period.
	//
	// Key: billing period in "YYYY-MM" format (e.g., "2026-01")
	SendMonthlySummary() ingress.Requester[*SendMonthlySummaryRequest, *SendMonthlySummaryResponse]
}

type quotaCheckServiceIngressClient struct {
	client      *ingress.Client
	serviceName string
	key         string
}

func NewQuotaCheckServiceIngressClient(client *ingress.Client, key string) QuotaCheckServiceIngressClient {
	return &quotaCheckServiceIngressClient{
		client,
		"hydra.v1.QuotaCheckService",
		key,
	}
}

func (c *quotaCheckServiceIngressClient) RunCheck() ingress.Requester[*RunCheckRequest, *RunCheckResponse] {
	codec := encoding.ProtoJSONCodec
	return ingress.NewRequester[*RunCheckRequest, *RunCheckResponse](c.client, c.serviceName, "RunCheck", &c.key, &codec)
}

func (c *quotaCheckServiceIngressClient) SendMonthlySummary() ingress.Requester[*SendMonthlySummaryRequest, *SendMonthlySummaryResponse] {
	codec := encoding.ProtoJSONCodec
	return ingress.NewRequester[*SendMonthlySummaryRequest, *SendMonthlySummaryResponse](c.client, c.serviceName, "SendMonthlySummary", &c.key, &codec)
}

// QuotaCheckServiceServer is the server API for hydra.v1.QuotaCheckService service.
// All implementations should embed UnimplementedQuotaCheckServiceServer
// for forward compatibility.
//
// QuotaCheckService monitors workspace quota usage and sends notifications.
//
// Keyed by billing period (e.g., "2026-01") to track notifications per month.
// Uses Restate state to deduplicate notifications - each workspace is only
// notified once per billing period when they first exceed their quota.
type QuotaCheckServiceServer interface {
	// RunCheck queries all workspace usage and sends Slack notifications for
	// newly exceeded quotas. Safe to call multiple times per day - uses state
	// to avoid duplicate notifications.
	//
	// Key: billing period in "YYYY-MM" format (e.g., "2026-01")
	RunCheck(ctx sdk_go.ObjectContext, req *RunCheckRequest) (*RunCheckResponse, error)
	// SendMonthlySummary sends a summary of all exceeded workspaces for the month.
	// Intended to be called on the last day of the billing period.
	//
	// Key: billing period in "YYYY-MM" format (e.g., "2026-01")
	SendMonthlySummary(ctx sdk_go.ObjectContext, req *SendMonthlySummaryRequest) (*SendMonthlySummaryResponse, error)
}

// UnimplementedQuotaCheckServiceServer should be embedded to have
// forward compatible implementations.
//
// NOTE: this should be embedded by value instead of pointer to avoid a nil
// pointer dereference when methods are called.
type UnimplementedQuotaCheckServiceServer struct{}

func (UnimplementedQuotaCheckServiceServer) RunCheck(ctx sdk_go.ObjectContext, req *RunCheckRequest) (*RunCheckResponse, error) {
	return nil, sdk_go.TerminalError(fmt.Errorf("method RunCheck not implemented"), 501)
}
func (UnimplementedQuotaCheckServiceServer) SendMonthlySummary(ctx sdk_go.ObjectContext, req *SendMonthlySummaryRequest) (*SendMonthlySummaryResponse, error) {
	return nil, sdk_go.TerminalError(fmt.Errorf("method SendMonthlySummary not implemented"), 501)
}
func (UnimplementedQuotaCheckServiceServer) testEmbeddedByValue() {}

// UnsafeQuotaCheckServiceServer may be embedded to opt out of forward compatibility for this service.
// Use of this interface is not recommended, as added methods to QuotaCheckServiceServer will
// result in compilation errors.
type UnsafeQuotaCheckServiceServer interface {
	mustEmbedUnimplementedQuotaCheckServiceServer()
}

func NewQuotaCheckServiceServer(srv QuotaCheckServiceServer, opts ...sdk_go.ServiceDefinitionOption) sdk_go.ServiceDefinition {
	// If the following call panics, it indicates UnimplementedQuotaCheckServiceServer was
	// embedded by pointer and is nil.  This will cause panics if an
	// unimplemented method is ever invoked, so we test this at initialization
	// time to prevent it from happening at runtime later due to I/O.
	if t, ok := srv.(interface{ testEmbeddedByValue() }); ok {
		t.testEmbeddedByValue()
	}
	sOpts := append([]sdk_go.ServiceDefinitionOption{sdk_go.WithProtoJSON}, opts...)
	router := sdk_go.NewObject("hydra.v1.QuotaCheckService", sOpts...)
	router = router.Handler("RunCheck", sdk_go.NewObjectHandler(srv.RunCheck))
	router = router.Handler("SendMonthlySummary", sdk_go.NewObjectHandler(srv.SendMonthlySummary))
	return router
}
