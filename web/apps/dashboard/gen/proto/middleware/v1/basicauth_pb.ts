// @generated by protoc-gen-es v2.8.0 with parameter "target=ts"
// @generated from file middleware/v1/basicauth.proto (package sentinel.v1, syntax proto3)
/* eslint-disable */

import type { GenFile, GenMessage } from "@bufbuild/protobuf/codegenv2";
import { fileDesc, messageDesc } from "@bufbuild/protobuf/codegenv2";
import type { Message } from "@bufbuild/protobuf";

/**
 * Describes the file middleware/v1/basicauth.proto.
 */
export const file_middleware_v1_basicauth: GenFile = /*@__PURE__*/
  fileDesc("Ch1taWRkbGV3YXJlL3YxL2Jhc2ljYXV0aC5wcm90bxILc2VudGluZWwudjEiQgoJQmFzaWNBdXRoEjUKC2NyZWRlbnRpYWxzGAEgAygLMiAuc2VudGluZWwudjEuQmFzaWNBdXRoQ3JlZGVudGlhbCI+ChNCYXNpY0F1dGhDcmVkZW50aWFsEhAKCHVzZXJuYW1lGAEgASgJEhUKDXBhc3N3b3JkX2hhc2gYAiABKAlCqQEKD2NvbS5zZW50aW5lbC52MUIOQmFzaWNhdXRoUHJvdG9QAVo5Z2l0aHViLmNvbS91bmtleWVkL3Vua2V5L2dlbi9wcm90by9zZW50aW5lbC92MTtzZW50aW5lbHYxogIDU1hYqgILU2VudGluZWwuVjHKAgtTZW50aW5lbFxWMeICF1NlbnRpbmVsXFYxXEdQQk1ldGFkYXRh6gIMU2VudGluZWw6OlYxYgZwcm90bzM");

/**
 * BasicAuth validates HTTP Basic credentials (RFC 7617) and produces a
 * [Principal] on success.
 *
 * This policy exists for integrating with systems that only support HTTP
 * Basic authentication â€” legacy services, webhook senders that require
 * Basic auth for delivery verification, and simple internal APIs where
 * issuing API keys or configuring JWT infrastructure is unnecessary overhead.
 * For new APIs, [KeyAuth] or [JWTAuth] are almost always better choices
 * because they support richer metadata, rotation, and per-key controls.
 *
 * On successful validation, BasicAuth produces a [Principal] with type
 * PRINCIPAL_TYPE_BASIC. The subject is set to the authenticated username,
 * and claims is empty because the HTTP Basic protocol carries no additional
 * metadata beyond the username/password pair.
 *
 * Credentials are configured as a static list with BCrypt-hashed passwords.
 * Sentinel never stores or accepts plaintext passwords in configuration.
 * The static list means credential changes require a config update and
 * redeployment, which is acceptable for the use cases this policy targets
 * but would be impractical for large user bases (use JWTAuth for those).
 *
 * @generated from message sentinel.v1.BasicAuth
 */
export type BasicAuth = Message<"sentinel.v1.BasicAuth"> & {
  /**
   * The list of valid username/password_hash pairs. Sentinel checks the
   * request's Basic credentials against each entry until a match is found
   * or the list is exhausted. Order does not affect security, but placing
   * the most commonly used credentials first may improve average-case
   * performance for large lists.
   *
   * @generated from field: repeated sentinel.v1.BasicAuthCredential credentials = 1;
   */
  credentials: BasicAuthCredential[];
};

/**
 * Describes the message sentinel.v1.BasicAuth.
 * Use `create(BasicAuthSchema)` to create a new message.
 */
export const BasicAuthSchema: GenMessage<BasicAuth> = /*@__PURE__*/
  messageDesc(file_middleware_v1_basicauth, 0);

/**
 * BasicAuthCredential represents a single valid username and password
 * combination. The password is stored as a BCrypt hash to ensure that
 * configuration files and proto serializations never contain plaintext
 * secrets. Operators generate the hash offline (e.g., via htpasswd or
 * bcrypt CLI tools) and paste the hash into the configuration.
 *
 * @generated from message sentinel.v1.BasicAuthCredential
 */
export type BasicAuthCredential = Message<"sentinel.v1.BasicAuthCredential"> & {
  /**
   * The expected username, matched exactly (case-sensitive).
   *
   * @generated from field: string username = 1;
   */
  username: string;

  /**
   * BCrypt hash of the password. Must be a valid BCrypt hash string
   * (starting with "$2a$", "$2b$", or "$2y$"). Sentinel verifies the
   * request's password against this hash using constant-time comparison.
   * Plaintext passwords are never stored in configuration.
   *
   * @generated from field: string password_hash = 2;
   */
  passwordHash: string;
};

/**
 * Describes the message sentinel.v1.BasicAuthCredential.
 * Use `create(BasicAuthCredentialSchema)` to create a new message.
 */
export const BasicAuthCredentialSchema: GenMessage<BasicAuthCredential> = /*@__PURE__*/
  messageDesc(file_middleware_v1_basicauth, 1);

