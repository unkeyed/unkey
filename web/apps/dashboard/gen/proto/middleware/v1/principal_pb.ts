// @generated by protoc-gen-es v2.8.0 with parameter "target=ts"
// @generated from file middleware/v1/principal.proto (package sentinel.v1, syntax proto3)
/* eslint-disable */

import type { GenEnum, GenFile, GenMessage } from "@bufbuild/protobuf/codegenv2";
import { enumDesc, fileDesc, messageDesc } from "@bufbuild/protobuf/codegenv2";
import type { Message } from "@bufbuild/protobuf";

/**
 * Describes the file middleware/v1/principal.proto.
 */
export const file_middleware_v1_principal: GenFile = /*@__PURE__*/
  fileDesc("Ch1taWRkbGV3YXJlL3YxL3ByaW5jaXBhbC5wcm90bxILc2VudGluZWwudjEiqQEKCVByaW5jaXBhbBIPCgdzdWJqZWN0GAEgASgJEigKBHR5cGUYAiABKA4yGi5zZW50aW5lbC52MS5QcmluY2lwYWxUeXBlEjIKBmNsYWltcxgDIAMoCzIiLnNlbnRpbmVsLnYxLlByaW5jaXBhbC5DbGFpbXNFbnRyeRotCgtDbGFpbXNFbnRyeRILCgNrZXkYASABKAkSDQoFdmFsdWUYAiABKAk6AjgBKn0KDVByaW5jaXBhbFR5cGUSHgoaUFJJTkNJUEFMX1RZUEVfVU5TUEVDSUZJRUQQABIaChZQUklOQ0lQQUxfVFlQRV9BUElfS0VZEAESFgoSUFJJTkNJUEFMX1RZUEVfSldUEAISGAoUUFJJTkNJUEFMX1RZUEVfQkFTSUMQA0KpAQoPY29tLnNlbnRpbmVsLnYxQg5QcmluY2lwYWxQcm90b1ABWjlnaXRodWIuY29tL3Vua2V5ZWQvdW5rZXkvZ2VuL3Byb3RvL3NlbnRpbmVsL3YxO3NlbnRpbmVsdjGiAgNTWFiqAgtTZW50aW5lbC5WMcoCC1NlbnRpbmVsXFYx4gIXU2VudGluZWxcVjFcR1BCTWV0YWRhdGHqAgxTZW50aW5lbDo6VjFiBnByb3RvMw");

/**
 * Principal is the authenticated entity produced by any authentication policy.
 *
 * This message is the composition seam that decouples authentication from
 * everything else. Authentication policies (KeyAuth, JWTAuth, BasicAuth) each
 * verify credentials in their own way, but they all produce the same Principal
 * output. Downstream policies — RateLimit for per-subject or per-claim
 * throttling — consume the Principal without knowing or caring which auth
 * method created it.
 *
 * The name "Principal" rather than "User" is deliberate. The authenticated
 * entity might be a human user, an API key representing a service, or an
 * OAuth token from a third-party integration. "Principal" captures all of
 * these without implying a specific identity model.
 *
 * Each authn policy populates the Principal differently:
 *
 *   KeyAuth:    subject = key owner ID or key ID, claims = key metadata
 *   JWTAuth:    subject = value of subject_claim (default "sub"), claims = forwarded JWT claims
 *   BasicAuth:  subject = username, claims = empty
 *
 * Only one Principal exists per request. If multiple authn policies match a
 * request, the first successful one wins and later authn policies are skipped.
 * This prevents ambiguity about which identity is "the" authenticated entity.
 *
 * @generated from message sentinel.v1.Principal
 */
export type Principal = Message<"sentinel.v1.Principal"> & {
  /**
   * The authenticated identity string. What this contains depends on the authn
   * method: a user ID from a JWT sub claim, an Unkey key owner ID, or a
   * username from Basic auth. Downstream policies use this as the primary
   * identity key for rate limiting and audit logging.
   *
   * @generated from field: string subject = 1;
   */
  subject: string;

  /**
   * Which authentication method produced this principal. This allows
   * downstream policies to make auth-method-aware decisions if needed (for
   * example, applying different rate limits to API key vs JWT authentication),
   * though most policies treat all principal types identically.
   *
   * @generated from field: sentinel.v1.PrincipalType type = 2;
   */
  type: PrincipalType;

  /**
   * Arbitrary key-value metadata from the authentication source. JWTAuth
   * populates this with forwarded token claims (org_id, plan, role, etc.).
   * KeyAuth populates it with key metadata from Unkey. BasicAuth leaves it
   * empty since that protocol carries no additional claims.
   *
   * The map uses string values rather than a richer type because claims are
   * primarily consumed by RateLimit (via PrincipalClaimKey) and log
   * enrichment, both of which operate on strings. Complex claim values
   * (arrays, nested objects) are JSON-encoded.
   *
   * @generated from field: map<string, string> claims = 3;
   */
  claims: { [key: string]: string };
};

/**
 * Describes the message sentinel.v1.Principal.
 * Use `create(PrincipalSchema)` to create a new message.
 */
export const PrincipalSchema: GenMessage<Principal> = /*@__PURE__*/
  messageDesc(file_middleware_v1_principal, 0);

/**
 * PrincipalType identifies which authentication method produced a [Principal].
 * This enum has a value for each authn policy type in the middleware schema.
 *
 * @generated from enum sentinel.v1.PrincipalType
 */
export enum PrincipalType {
  /**
   * @generated from enum value: PRINCIPAL_TYPE_UNSPECIFIED = 0;
   */
  UNSPECIFIED = 0,

  /**
   * Produced by [KeyAuth]. The subject is an Unkey key owner or key ID.
   *
   * @generated from enum value: PRINCIPAL_TYPE_API_KEY = 1;
   */
  API_KEY = 1,

  /**
   * Produced by [JWTAuth]. The subject is a JWT claim value.
   *
   * @generated from enum value: PRINCIPAL_TYPE_JWT = 2;
   */
  JWT = 2,

  /**
   * Produced by [BasicAuth]. The subject is the HTTP Basic username.
   *
   * @generated from enum value: PRINCIPAL_TYPE_BASIC = 3;
   */
  BASIC = 3,
}

/**
 * Describes the enum sentinel.v1.PrincipalType.
 */
export const PrincipalTypeSchema: GenEnum<PrincipalType> = /*@__PURE__*/
  enumDesc(file_middleware_v1_principal, 0);

