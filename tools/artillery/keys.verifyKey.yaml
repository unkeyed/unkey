config:
  target: https://api.unkey.com
  phases:
    - name: Ramp
      duration: 60m
      arrivalRate: 1
      rampTo: 400

  payload:
    path: "./.keys.csv"
    fields:
      - key

  # Load & configure a couple of useful plugins
  # https://docs.art/reference/extensions
  plugins:
    ensure: {}
    expect: {}

  ensure:
    thresholds:
      - http.response_time.p50: 20
      - http.response_time.p90: 50
      - http.response_time.p99: 100

scenarios:
  - flow:
      - post:
          url: "/v2/keys.verifyKey"
          headers:
            Authorization: "Bearer {{ $env.UNKEY_ROOT_KEY }}"
          json:
            key: "{{ key }}"
          expect:
            - statusCode: 200
            - contentType: json
