syntax = "proto3";

package vault.v1;

import "buf/validate/validate.proto";

option go_package = "github.com/unkeyed/unkey/gen/proto/vault/v1;vaultv1";

message LivenessRequest {}
message LivenessResponse {
  string status = 1;
}

message EncryptRequest {
  string keyring = 1 [(buf.validate.field).string.max_len = 64];
  string data = 2 [(buf.validate.field).string.max_len = 32768];
}

message EncryptResponse {
  string encrypted = 1;
  string key_id = 2;
}

message DecryptRequest {
  string keyring = 1 [(buf.validate.field).string.max_len = 64];
  string encrypted = 2 [(buf.validate.field).string.max_len = 32768];
}

message DecryptResponse {
  string plaintext = 1;
}

message ReEncryptRequest {
  string keyring = 1 [(buf.validate.field).string.max_len = 64];
  string encrypted = 2 [(buf.validate.field).string.max_len = 32768];

  // Specify the key_id to use for re-encryption. If not provided, the latest will be used
  optional string key_id = 3 [(buf.validate.field).string.max_len = 64];
}
message ReEncryptResponse {
  string encrypted = 1;
  string key_id = 2;
}

message ReEncryptDEKsRequest {}
message ReEncryptDEKsResponse {}

service VaultService {
  rpc Liveness(LivenessRequest) returns (LivenessResponse) {}
  rpc Encrypt(EncryptRequest) returns (EncryptResponse) {}
  rpc Decrypt(DecryptRequest) returns (DecryptResponse) {}

  // ReEncrypt rec
  rpc ReEncrypt(ReEncryptRequest) returns (ReEncryptResponse) {}
}
