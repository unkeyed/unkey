// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: environment_find_with_settings.sql

package db

import (
	"context"

	dbtype "github.com/unkeyed/unkey/pkg/db/types"
)

const findEnvironmentWithSettingsByProjectIdAndSlug = `-- name: FindEnvironmentWithSettingsByProjectIdAndSlug :one
SELECT
    e.pk, e.id, e.workspace_id, e.project_id, e.slug, e.description, e.sentinel_config, e.delete_protection, e.created_at, e.updated_at,
    bs.dockerfile,
    bs.docker_context,
    rs.port,
    rs.cpu_millicores,
    rs.memory_mib,
    rs.command,
    rs.shutdown_signal,
    rs.healthcheck,
    rs.region_config
FROM environments e
INNER JOIN environment_build_settings bs ON bs.environment_id = e.id
INNER JOIN environment_runtime_settings rs ON rs.environment_id = e.id
WHERE e.workspace_id = ?
  AND e.project_id = ?
  AND e.slug = ?
`

type FindEnvironmentWithSettingsByProjectIdAndSlugParams struct {
	WorkspaceID string `db:"workspace_id"`
	ProjectID   string `db:"project_id"`
	Slug        string `db:"slug"`
}

type FindEnvironmentWithSettingsByProjectIdAndSlugRow struct {
	Environment    Environment                              `db:"environment"`
	Dockerfile     string                                   `db:"dockerfile"`
	DockerContext  string                                   `db:"docker_context"`
	Port           int32                                    `db:"port"`
	CpuMillicores  int32                                    `db:"cpu_millicores"`
	MemoryMib      int32                                    `db:"memory_mib"`
	Command        dbtype.StringSlice                       `db:"command"`
	ShutdownSignal EnvironmentRuntimeSettingsShutdownSignal `db:"shutdown_signal"`
	Healthcheck    dbtype.NullHealthcheck                   `db:"healthcheck"`
	RegionConfig   dbtype.RegionConfig                      `db:"region_config"`
}

// FindEnvironmentWithSettingsByProjectIdAndSlug
//
//	SELECT
//	    e.pk, e.id, e.workspace_id, e.project_id, e.slug, e.description, e.sentinel_config, e.delete_protection, e.created_at, e.updated_at,
//	    bs.dockerfile,
//	    bs.docker_context,
//	    rs.port,
//	    rs.cpu_millicores,
//	    rs.memory_mib,
//	    rs.command,
//	    rs.shutdown_signal,
//	    rs.healthcheck,
//	    rs.region_config
//	FROM environments e
//	INNER JOIN environment_build_settings bs ON bs.environment_id = e.id
//	INNER JOIN environment_runtime_settings rs ON rs.environment_id = e.id
//	WHERE e.workspace_id = ?
//	  AND e.project_id = ?
//	  AND e.slug = ?
func (q *Queries) FindEnvironmentWithSettingsByProjectIdAndSlug(ctx context.Context, db DBTX, arg FindEnvironmentWithSettingsByProjectIdAndSlugParams) (FindEnvironmentWithSettingsByProjectIdAndSlugRow, error) {
	row := db.QueryRowContext(ctx, findEnvironmentWithSettingsByProjectIdAndSlug, arg.WorkspaceID, arg.ProjectID, arg.Slug)
	var i FindEnvironmentWithSettingsByProjectIdAndSlugRow
	err := row.Scan(
		&i.Environment.Pk,
		&i.Environment.ID,
		&i.Environment.WorkspaceID,
		&i.Environment.ProjectID,
		&i.Environment.Slug,
		&i.Environment.Description,
		&i.Environment.SentinelConfig,
		&i.Environment.DeleteProtection,
		&i.Environment.CreatedAt,
		&i.Environment.UpdatedAt,
		&i.Dockerfile,
		&i.DockerContext,
		&i.Port,
		&i.CpuMillicores,
		&i.MemoryMib,
		&i.Command,
		&i.ShutdownSignal,
		&i.Healthcheck,
		&i.RegionConfig,
	)
	return i, err
}
