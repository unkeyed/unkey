// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: deployment_find_latest_ready_by_app_and_env.sql

package db

import (
	"context"
)

const findLatestReadyDeploymentByAppAndEnv = `-- name: FindLatestReadyDeploymentByAppAndEnv :one
SELECT id
FROM deployments
WHERE app_id = ?
  AND environment_id = ?
  AND status = 'ready'
  AND id != ?
ORDER BY created_at DESC
LIMIT 1
`

type FindLatestReadyDeploymentByAppAndEnvParams struct {
	AppID         string `db:"app_id"`
	EnvironmentID string `db:"environment_id"`
	ExcludeID     string `db:"exclude_id"`
}

// FindLatestReadyDeploymentByAppAndEnv
//
//	SELECT id
//	FROM deployments
//	WHERE app_id = ?
//	  AND environment_id = ?
//	  AND status = 'ready'
//	  AND id != ?
//	ORDER BY created_at DESC
//	LIMIT 1
func (q *Queries) FindLatestReadyDeploymentByAppAndEnv(ctx context.Context, db DBTX, arg FindLatestReadyDeploymentByAppAndEnvParams) (string, error) {
	row := db.QueryRowContext(ctx, findLatestReadyDeploymentByAppAndEnv, arg.AppID, arg.EnvironmentID, arg.ExcludeID)
	var id string
	err := row.Scan(&id)
	return id, err
}
