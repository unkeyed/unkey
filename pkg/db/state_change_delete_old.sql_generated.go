// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: state_change_delete_old.sql

package db

import (
	"context"
)

const deleteOldStateChanges = `-- name: DeleteOldStateChanges :execrows
DELETE FROM ` + "`" + `state_changes` + "`" + `
WHERE created_at < ?
LIMIT 10000
`

// Retention cleanup: deletes state changes older than the cutoff timestamp.
// Uses LIMIT to avoid long-running transactions; call repeatedly until 0 rows affected.
//
//	DELETE FROM `state_changes`
//	WHERE created_at < ?
//	LIMIT 10000
func (q *Queries) DeleteOldStateChanges(ctx context.Context, db DBTX, cutoffMs uint64) (int64, error) {
	result, err := db.ExecContext(ctx, deleteOldStateChanges, cutoffMs)
	if err != nil {
		return 0, err
	}
	return result.RowsAffected()
}
