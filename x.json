{
  "kind": "CiliumNetworkPolicy",
  "spec": {
    "ingress": [
      {
        "toPorts": [{ "ports": [{ "port": "8080", "protocol": "TCP" }] }],
        "fromEndpoints": [
          {
            "matchLabels": {
              "unkey.com/workspace.id": "ws_local",
              "unkey.com/environment.id": "env_0FqJJZJn",
              "io.kubernetes.pod.namespace": "sentinel"
            }
          }
        ]
      }
    ],
    "description": "Allow ingress from sentinel for workspace ws_local environment env_0FqJJZJn",
    "endpointSelector": {
      "matchLabels": {
        "app.kubernetes.io/component": "deployment",
        "app.kubernetes.io/managed-by": "krane"
      }
    }
  },
  "status": {},
  "metadata": {
    "name": "lnqfqaom",
    "labels": {
      "unkey.com/workspace.id": "ws_local",
      "unkey.com/environment.id": "env_0FqJJZJn",
      "unkey.com/networkpolicy.id": "net_pKtcGC2K",
      "app.kubernetes.io/component": "deployment",
      "app.kubernetes.io/managed-by": "krane"
    },
    "namespace": "hfdlt06d"
  },
  "apiVersion": "cilium.io/v2"
}



policy := &ciliumv2.CiliumNetworkPolicy{
		TypeMeta: metav1.TypeMeta{
			APIVersion: "cilium.io/v2",
			Kind:       "CiliumNetworkPolicy",
		},
		ObjectMeta: metav1.ObjectMeta{
			Name:      "allow-sentinel-ingress",
			Namespace: namespace,
		},
		Spec: &api.Rule{
			Description: fmt.Sprintf("Allow ingress from sentinel for workspace %s environment %s", workspaceID, environmentID),
			EndpointSelector: api.EndpointSelector{
				LabelSelector: &slim_metav1.LabelSelector{
					MatchLabels: map[string]string{
						"app.kubernetes.io/managed-by": "krane",
						"app.kubernetes.io/component":  "deployment",
					},
				},
			},
			Ingress: []api.IngressRule{
				{
					IngressCommonRule: api.IngressCommonRule{
						FromEndpoints: []api.EndpointSelector{
							{
								LabelSelector: &slim_metav1.LabelSelector{
									MatchLabels: map[string]string{
										"io.kubernetes.pod.namespace": NamespaceSentinel,
										"unkey.com/workspace.id":      workspaceID,
										"unkey.com/environment.id":    environmentID,
									},
								},
							},
						},
					},
					ToPorts: api.PortRules{
						{
							Ports: []api.PortProtocol{
								{
									Port:     strconv.Itoa(DeploymentPort),
									Protocol: api.ProtoTCP,
								},
							},
						},
					},
				},
			},
		},
	